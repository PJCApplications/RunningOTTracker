<!DOCTYPE html>
<html>
<head>

    <title>Running OT Tracker</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="CSS/jquery.mobile-1.4.2.css" />

    <script type="text/javascript" charset="utf-8" src="js/cordova.js"></script>

    <script type="text/javascript" charset="utf-8" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/jquery.mobile-1.4.2.js"></script>
</head>

<body>

<div data-role=page id=home>
    <div data-role=header>
        <h1>Home</h1>
    </div>

    <div data-role=content>
        <a href=# data-role=button id=create> Create overtime table </a>
        <a href=# data-role=button id=remove> Delete overtime table </a>

        <div data-role="fieldcontain" data-controltype="selectmenu">
            <label for="type">
                Choose:
            </label>
            <select id="type" name="">
                <option value="LF">Late Finish</option>
                <option value="ES">Early Start</option>
                <option value="OOO">Out of Area Meal Break</option>
                <option value="DMB">Disturbed Meal Break</option>
                <option value="LMB">Late Meal Break</option>
            </select>
        </div>

        <div data-role="fieldcontain" data-controltype="selectmenu">
            <label for="year">
                Year:
            </label>
            <select id="year" name="">
                <option value="2014">2014</option>
                <option value="2015">2015</option>
                <option value="2016">2016</option>
                <option value="2017">2017</option>
                <option value="2018">2018</option>
            </select>
        </div>

        <div data-role="fieldcontain" data-controltype="selectmenu">
            <label for="month">
                Month:
            </label>
            <select id="month" name="">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
            </select>
        </div>

        <div data-role="fieldcontain" data-controltype="selectmenu">
            <label for="day">
                Day:
            </label>
            <select id="day" name="">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">12</option>
                <option value="14">12</option>
                <option value="15">12</option>
                <option value="16">12</option>
                <option value="17">12</option>
                <option value="18">12</option>
                <option value="19">12</option>
                <option value="20">12</option>
                <option value="21">12</option>
                <option value="22">12</option>
                <option value="23">12</option>
                <option value="24">12</option>
                <option value="25">12</option>
                <option value="26">12</option>
                <option value="27">12</option>
                <option value="28">12</option>
                <option value="29">12</option>
                <option value="30">12</option>
                <option value="31">12</option>
            </select>
        </div>

        <span> datetimelog </span>
        <input type=datetime id=datetimelog value="2014-06-02 08:23:00">
        <span> cad </span>
        <input type=number id=cad>
        <span> vehicle </span>
        <input type=number id=vehicle>
        <span> loc </span>
        <input type=text id=loc>
        <span> notes </span>
        <input type=text id=notes>
        <span> email </span>
        <input type=email id=email>
        <a href=# data-role=button id=insert> Insert the Overtime </a>
        <a href=# data-role=button id=list> List Overtime </a>
    </div>
</div>

<div data-role=page id=win2 data-add-back-btn=true>
    <div data-role=header>
        <h1>List of customers</h1>
    </div>

    <div data-role=content>
    </div>
</div>

</body>
</html>

<script>

    var db = openDatabase ("Test", "1.0", "Test", 65535);

    $("#create").bind ("click", function (event)
    {
        db.transaction (function (transaction)
        {
            var sql = "CREATE TABLE overtime " +
                    " (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, " +
                    "datetimelog DATETIME, " +
                    "cad VARCHAR(5), " +
                    "vehicle VARCHAR(10), " +
                    "loc VARCHAR(100), " +
                    "type VARCHAR(6), " +
                    "notes VARCHAR(250), " +
                    "email VARCHAR(100))";
            transaction.executeSql (sql, undefined, function ()
            {
                alert ("Table created");
            }, error);
        });
    });

    $("#remove").bind ("click", function (event)
    {
        if (!confirm ("Delete table?", "")) return;;
        db.transaction (function (transaction)
        {
            var sql = "DROP TABLE overtime";
            transaction.executeSql (sql, undefined, ok, error);
        });
    });

    $("#insert").bind ("click", function (event)
    {
        var datetimelog = $("#datetimelog").val ();
        var cad = $("#cad").val ();
        var vehicle = $("#vehicle").val ();
        var loc = $("#loc").val ();
        var type = $("#type").val ();
        var notes = $("#notes").val ();
        var email = $("#email").val ();

        db.transaction (function (transaction)
        {
            var sql = "INSERT INTO overtime (datetimelog, cad, vehicle, loc, type, notes, email) VALUES (?, ?, ?, ?, ?, ?, ?)";
            transaction.executeSql (sql, [datetimelog, cad, vehicle, loc, type, notes, email], function ()
            {
                alert ("Log inserted");
            }, error);
        });
    });

    $("#list").bind ("click", function (event)
    {
        db.transaction (function (transaction)
        {
            var sql = "SELECT * FROM overtime";
            transaction.executeSql (sql, undefined,
                    function (transaction, result)
                    {
                        var html = "<ul>";
                        if (result.rows.length)
                        {
                            for (var i = 0; i < result.rows.length; i++)
                            {
                                var row = result.rows.item (i);
                                var id = row.id;
                                var datetimelog = row.datetimelog;
                                var cad = row.cad;
                                var vehicle = row.vehicle;
                                var loc = row.loc;
                                var type = row.type;
                                var notes = row.notes;
                                var email = row.email;
                                html += "<li>" +
                                        datetimelog + "&nbsp;" +
                                        cad + "&nbsp;" +
                                        vehicle +  "&nbsp;" +
                                        loc + "&nbsp;" +
                                        type + "&nbsp;" +
                                        notes + "&nbsp;" +
                                        email + "&nbsp;" +
                                        "</li>";
                            }
                        }
                        else
                        {
                            html += "<li> No Logs </li>";
                        }

                        html += "</ul>";

                        $("#win2").unbind ().bind ("pagebeforeshow", function ()
                        {
                            var $content = $("#win2 div:jqmData(role=content)");
                            $content.html (html);
                            var $ul = $content.find ("ul");
                            $ul.listview ();
                        });

                        $.mobile.changePage ($("#win2"));

                    }, error);
        });
    });

    function ok ()
    {
    }

    function error (transaction, err)
    {
        alert ("DB error : " + err.message);
        return false;
    }

</script>
